async function vectorize_rag_retrieve(params,userSettings){if(!userSettings||!userSettings.accessToken)throw new Error("Vectorize Access Token is not defined in user settings.");if(!userSettings.orgId)throw new Error("Organization ID is not defined in user settings.");if(!userSettings.pipelineId)throw new Error("Pipeline ID is not defined in user settings.");const{question}=params;if(!question)throw new Error("Search query (question) is required.");const apiUrl=`https://api.vectorize.io/v1/org/${userSettings.orgId}/pipelines/${userSettings.pipelineId}/retrieval?stringify=on`;const requestPayload={question:question,numResults:parseInt(userSettings.numResults,10)||5,rerank:userSettings.rerank==="true"};try{const response=await fetch(apiUrl,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`${userSettings.accessToken}`},body:JSON.stringify(requestPayload)});if(!response.ok){const errorData=await response.json();throw new Error(`Vectorize API error: ${response.status} - ${errorData.error||'Unknown error'}`)}const data=await response.json();return data}catch(error){throw new Error(`Failed to perform Vectorize RAG retrieval: ${error.message}`)}}
